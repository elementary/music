app-id: io.elementary.music
runtime: io.elementary.Platform
runtime-version: 'daily'
sdk: io.elementary.Sdk
command: io.elementary.music
finish-args:
  - '--share=ipc'
  - '--socket=fallback-x11'
  - '--socket=wayland'
  - '--socket=pulseaudio'

  # needed for perfers-color-scheme
  - '--system-talk-name=org.freedesktop.Accounts'

  - '--talk-name=org.gnome.SettingsDaemon.MediaKeys'

  - '--metadata=X-DConf=migrate-path=/io/elementary/music/'
modules:
  - name: Adwaita
    buildsystem: meson
    sources:
      - type: git
        url: https://gitlab.gnome.org/GNOME/libadwaita
        tag: 1.0.1
    modules:
      - name: sassc
        cleanup: [ "*" ]
        sources:
          - type: git
            url: https://github.com/sass/sassc.git
            tag: 3.6.1

          - type: script
            dest-filename: autogen.sh
            commands: ["autoreconf -si"]
        modules:
          - name: libsass
            cleanup: [ "*" ]
            sources:
              - type: git
                url: https://github.com/sass/libsass.git
                tag: 3.6.4

              - type: script
                dest-filename: autogen.sh
                commands: ["autoreconf -si"]

  - name: music
    buildsystem: meson
    sources:
      - type: dir
        path: .
